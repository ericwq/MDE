## 第 6 章：值对象 (Value Objects)

#### ▶[上一节](../ch5/4.md)

*<p align="right">价格是你付出的，价值是你得到的。</br>——Warren Buffett</p>*

尽管常常被实体思维所掩盖，但`Value Objects`是 DDD 中至关重要的构建块。通常被建模为值的对象示例包括：数字，如 3、10 和 293.51；文本字符串，如 “hello, world!” 和 “Domain-Driven Design”；日期；时间；更复杂的对象，例如由名、中间名、姓和头衔属性组成的一个人的全名；以及其他如货币、颜色、电话号码和邮政地址等。此外还有更复杂的类型。我将讨论那些使用你的 [Ubiquitous Language (1)](../ch1/0.md) 来建模领域概念的`Values`，以实现领域驱动设计的目标。

---
➜**了解`Value`的优势**

用于度量、量化或描述事物的值类型，更易于创建、测试、使用、优化和维护。

---

你可能会惊讶地发现，我们应该尽可能使用`Value Objects`而不是`Entities`来建模。即使某个领域概念必须被建模为`Entity`，该`Entity`的设计也应该更偏向于作为`Value`的容器，而不是子`Entity`的容器。这样的建议并不是基于随意的偏好。用于度量、量化或描述事物的值类型更易于创建、测试、使用、优化和维护。

---
**<center>本章路线图</center>**

• 学习如何理解一个领域概念的特征，以便将其建模为`Value`。
• 了解如何利用`Value Objects`来最小化集成复杂度。
• 考察以`Values`形式表达的领域标准类型（domain Standard Types）的使用。
• 思考 SaaSOvation 是如何认识到`Values`的重要性的。
• 学习 SaaSOvation 团队如何对其`Values`类型进行测试、实现和持久化。

---

---
<img src="../img/tips.3.png" width="50%" /></br>

起初，SaaSOvation 的团队在使用`Entities`方面有些过头了。这种情况实际上在 User（用户）和 Permission（权限）概念与协作功能纠缠在一起之前就已经开始出现了。从项目一开始，他们就遵循一种流行的思维模式：<ins>领域模型中的每一个元素都需要映射到自己的数据库表，并且所有属性都应该可以通过公共访问方法（public accessor methods）轻松地设置和获取。由于每个对象都有一个数据库主键，整个模型被紧密地缝合在一起，形成一个庞大而复杂的对象图。这种想法主要来自大多数开发人员在受到关系数据库过度影响时所具有的数据建模视角。在关系数据库中，一切都被规范化，并通过外键相互引用。
后来他们才意识到，陷入实体思维（entity-think）的浪潮不仅没有必要，而且在开发时间和精力上的成本也更高。</ins>

---

如果设计得当，一个`Value`实例可以被创建、传递，然后就被忘记。我们不必担心使用者以某种方式错误地修改了它，甚至根本不用担心它被修改。一个值对象的生命周期可长可短。它只是一个不会被破坏、也不会造成破坏的`Value`，按需出现和消失。

这让我们的心里一下子轻松了很多，就好比从一种没有内存管理机制的编程语言，切换到一种带垃圾回收的语言。有了`Values`所带来的这种使用上的轻松感，我们当然会希望在合理范围内尽可能多地使用它们。

那么，我们如何判断一个领域概念是否应该被建模为`Value`呢？我们必须密切关注它的特征。

- 当你只关心模型中某个元素的属性时，就把它归类为`VALUE OBJECT`。让它表达出它所承载的属性的含义，并为它赋予相关的功能。把`VALUE OBJECT`当作不可变的来对待。不要给它任何标识（identity），并避免那些为了维护`ENTITY`所必需的复杂设计。[[Evans, p. 99](../bibli.md#evans)]

尽管创建一个`Value type`可能很容易，但有时那些缺乏 DDD 经验的人在特定场景下选择将某个概念建模为`Entity`还是`Value`时，仍然会感到困惑。事实上，即使是有经验的设计师，有时也会在这个问题上纠结。除了向你展示如何实现一个`Value`之外，我还希望能消除一些围绕这个有时令人困惑的决策过程的神秘感。

#### ▶[下一节](1.md)
