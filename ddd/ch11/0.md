## 第 11 章 运用分析模式

#### ▶[上一节](../ch10/9.md)

深度模型与灵活的设计并非唾手可得。进步源于对领域知识的深入学习、充分的交流探讨以及反复的试错。不过，有时我们也能获得一些助力。

当经验丰富的开发者面对领域问题时，若发现熟悉的职责类型或关系网络，便能调用过往解决该问题的记忆：曾尝试过哪些模型？哪些有效？实施过程中遇到哪些困难？又是如何解决的？那些先前的试错经验，此刻突然与新情境产生了关联。其中部分模式已被记录并共享，使我们得以借鉴这些积累的经验。

与 [第二部分](../part2.md) 介绍的基础构建块模式以及 [第 10 章](../ch10/0.md) 阐述的灵活设计原则不同，这些模式属于更高层次且更专业的范畴，涉及使用少量对象来表达特定概念。它们让我们能够跳过代价高昂的试错过程，直接从一个既具表现力又可实现的模型开始，该模型能处理那些可能耗费大量精力才能掌握的微妙细节。以此为起点，我们进行重构与实验。这些并非现成的解决方案。

在《Analysis Patterns: Reusable Object Models》中，Martin Fowler 如此定义分析模式：

* 分析模式是一组概念集合，代表业务建模中的常见构造。它可能仅适用于单一领域，也可能横跨多个领域。[Fowler 1997](../references.md#fowler-1997) , p. 8.

Fowler 提出的分析模式源于实践经验，因此在合适的情境下具有实用价值。这些模式为面临复杂领域挑战的人提供了宝贵的起点，助力其迭代开发过程。其命名强调了概念本质。<ins>分析模式并非技术解决方案，而是引导你在特定领域构建模型的指南。</ins>

遗憾的是，这个名称未能传达的是：这些模式中包含大量关于实现的讨论，甚至涉及部分代码。Fowler 深谙脱离实际设计考量而进行分析的陷阱。以下这个引人深思的例子中，他甚至超越了部署范畴，探讨了特定模型选择对系统长期现场维护的影响：

* 当我们建立新的\[会计\]实践时，会创建一组新的过账规则实例。这一过程无需重新编译或重建系统，可在系统正常运行期间完成。虽然偶尔需要新增过账规则的子类型，但此类情况实属罕见。\[第 151 页\]

在成熟项目中，模型选择往往基于对应用程序的实践经验。各类组件的多种实现方案都曾被尝试过，其中部分方案已投入生产环境，甚至经历了维护阶段。当积累了这类经验时，许多问题便能避免。优秀的分析模式能够承载其他项目的经验，将模型洞察与设计方向及实现后果的深入探讨相结合。脱离此背景讨论模型理念会降低其应用价值，更可能导致分析与设计之间产生致命隔阂，这与 [MODEL-DRIVEN DESIGN](../glossary.md#model-driven-design) 理念背道而驰。

分析模式的原理和应用通过示例比抽象描述更容易说明。在本章中，我将给出两个开发者使用 [Fowler 1997](../references.md#fowler-1997) 中 “库存与会计” 一章的小型代表性模型样本的例子。分析模式将只作简要总结，以支持这些示例。显然，这并不是试图对这种模式进行分类，甚至也不是完全解释这些示例模式。重点是展示它们在领域驱动设计过程中的整合应用。

#### ▶[下一节](1.md)
