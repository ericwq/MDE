## 最终审视

#### ▶[上一节](11.md)

就这样。这次集成本可能将我们简单而概念一致的设计变成一团乱麻，但如今借助`ANTICORRUPTION LAYER`、 [SERVICE](../glossary.md#service) 和若干`ENTERPRISE SEGMENTS`，我们已将`Sales Management System`功能干净利落地整合到预订系统中，并丰富了领域模型。

最后一个设计问题：为何不让`Cargo`承担推导`Enterprise Segment`的责任？乍看之下，若所有推导依据的数据都存在于`Cargo`中，将其设为`Cargo`的派生属性似乎很优雅。可惜实际情况并非如此简单。`Enterprise Segments`的定义具有任意性，旨在沿着符合商业战略的维度进行分割。相同的实体 [ENTITIES](../ch5/2.md) 可能因不同目的而被划分为不同的分段。我们正在为特定`Cargo`的 *预订分配* 目的推导其`segment`，但该货物在税务核算目的下可能拥有完全不同的`Enterprise Segment`。即使`Sales Management System`因新销售策略而重新配置，分配`Enterprise Segment`也可能发生变化。因此`Cargo`必须了解`Allocation Checker`，这完全超出了其概念职责范围，且将被迫承载推导特定类型`Enterprise Segment`的方法。因此，推导该值的责任应由掌握分段规则的对象承担，而非持有适用规则的数据对象。这些规则可拆分至独立的 “`Strategy`” 对象中，该对象可传递给`Cargo`以允许其推导`Enterprise Segment`。此方案似乎超出了当前需求范围，但可作为后期设计的备选方案，且不应造成重大破坏性变更。

#### ▶[下一节](../part3.md)
