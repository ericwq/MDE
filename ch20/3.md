## 20.3 对现有系统的 MDSD 改造
通常，人们不仅希望使用 MDSD 开发新的系统，还希望将 MDSD 的优势应用到现有系统中，甚至通过为其配备新的技术基础使其现代化。

本书中介绍的过程和最佳实践也适用于这类项目，但在领域架构的引导过程中，具体步骤的重点和方向有所不同：

- 现有应用在很大程度上扮演着原型和参考实现的角色。在现代化的情况下，参考实现显示了新的目标架构。
- （MDSD）平台有可能无法清晰识别或与应用分离。如有必要，必须进行重构。
- 在参考实现中可能需要创建额外的（基础设施）代码，以便后续为遗留 (legacy) 应用生成标准接口或适配器。可能 *仅需* 为这些适配器生成补充代码，而遗留应用的核心部分并不转换为 MDSD。
- 在大多数情况下，遗留应用并不具备参考实现所需的清晰结构，例如以生成模板的形式推导转换规则。有必要分析哪些构建原则是有效的，哪些是无效的。必要时，必须通过重构将应用的某些部分改变为理想状态。
- 必须对领域分析和 DSL 构造进行调整，使其与遗留应用或新引入的基础架构代码的有效结构相匹配。
- 为创建参考设计/模型，遗留应用或其一部分将使用 DSL 进行改造 (remodel)。然后用它来验证代码生成。
- 通过应用开发主线中的 DSL 改造遗留应用的部分方面 (partial aspects)，然后生成新的实现骨架。如果适用，遗留应用的剩余代码也会集成到该框架中。如果是现代化改造，则进行迁移。

从这个清单中可以清楚地看出，*可能* 需要进行重大的结构调整，这取决于 MDSD 方法对遗留应用的影响有多深。实际情况，尤其是成本/收益比，只能通过仔细分析来确定。同样，在对遗留应用进行调整时，DSL、平台、生成代码和非生成代码之间的正确平衡也至关重要。

我们需要明确警告的是，不要认为对遗留应用进行简单的逆向工程（虽然毫无疑问也会产生一个模型）就可以替代 MDSD ：你将会得到以前应用的部分代码可视化，仅此而已。通过这种方式无法获得模型驱动软件开发的优势（见第 [18.1](../ch18/1.md) 节）。
