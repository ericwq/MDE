## 存储库: Repositories

#### ▶[上一节](7.md)

*查询访问以 [Ubiquitous Language](../ch1/2.md) 表达的 [Aggregates](7.md) 。*

仅用于查找对象的遍历关联大量存在，导致模型混乱。在成熟模型中，查询通常表达领域概念。然而查询也可能引发问题。

应用大多数数据库访问基础设施的技术复杂性极高，很快就会淹没客户端代码，这导致开发者简化领域层，从而使模型变得无关紧要。

查询框架可能会封装大部分技术复杂性，使开发人员能够以更自动化或声明性的方式从数据库中提取所需的确切数据，但这仅解决了问题的一部分。

不受约束的查询可能从对象中提取特定字段，破坏封装性；或从 [Aggregate](7.md) 内部实例化若干特定对象，绕过 [Aggregate](7.md) 根的管控，导致这些对象无法执行领域模型的规则。领域逻辑由此渗入查询和应用层代码， [Entities](2.md) 与 [Value Objects](3.md) 沦为单纯的数据容器。

因此：

<ins>**对于每种需要全局访问的 [Aggregate](7.md) 类型，创建一个服务，使其能够提供该 [Aggregate](7.md) 根类型所有对象的内存集合幻象。通过公认的全局接口设置访问权限。提供添加和移除对象的方法，这些方法将封装数据存储中实际的数据插入或移除操作。提供基于领域专家有意义的条件来选择对象的方法。返回完全实例化的对象或属性值符合条件的对象集合，从而封装实际存储与查询技术；或返回代理对象，以延迟加载方式模拟完全实例化的 [Aggregates](7.md) 。仅为实际需要直接访问的 [Aggregate](7.md) 根提供存储库。使应用逻辑聚焦于模型层，将所有对象存储与访问委托给存储库 (Repositories)。**</ins>

#### ▶[下一节](9.md)
